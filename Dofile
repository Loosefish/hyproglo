#!/bin/sh
set -e

do_() {
    do_halogen
    do_tags
}


do_server() {
    python hpg.py
}


do_halogen() {
    cd halogen
    case $1 in
        w)  pulp --before clear -w browserify --optimise --to ../server/app.js
            ;;
        *)  pulp browserify --optimise --to ../server/app.js
            ;;
    esac
    cd ..
}

do_tags() {
    psc-docs --format ctags halogen/src/**/*.purs > halogen/tags
}

do_ide() {
    cd halogen
    sleep 2 && echo '{"command":"load"}'|psc-ide-client &
    psc-ide-server
    cd ..
}
